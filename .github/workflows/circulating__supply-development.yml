name: Circulating Supply Development Cron Job

on: push

jobs:
  Circulating-Supply:
    name: Circulating Supply Deployment
    runs-on: ubuntu-latest
    steps:
      - name: Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: "18"
      - name: Checkout to circulating-supply branch
        uses: actions/checkout@v3
        with:
          ref: circulating-supply
      - name: "yarn install"
        run: yarn install
      - name: change branch to packages/utils directory
        run: cd packages/utils
      - name: Build tsc file using ts -b
        run: yarn tsc -b
        env:
          ALCHEMY_API_KEYS: ${{ secrets.ALCHEMY_API_KEYS }}
          BNB_RPC_URLS: ${{ secrets.BNB_RPC_URLS }}
      - name: serve dist file using node
        run: node dist/circulating-supply/circulating-supply
      - name: Make PR Comment
        uses: mshick/add-pr-comment@v2
        with:
          message: "Update circulating supply"
      - name: Push
        run: git push
